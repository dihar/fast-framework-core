"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(){void 0===window.ff&&(window.ff={}),window.ff.config||(window.ff.config={root:"/views/",ext:".mst"}),window.ff.state||!function(){window.ff.state={loaderIsActive:"true",loaderInError:"false"};var e=window.ff.state;e.showLoader=function(){e.loaderIsActive=!0,$(".ff-loader").addClass("ff-loader_show")},e.hideLoader=function(){e.loaderIsActive=!1,$(".ff-loader").removeClass("ff-loader_show")},e.errorLoader=function(t){e.loaderIsActive=!0,e.loaderInError=!1,$(".ff-loader").addClass("ff-loader_show").addClass("ff-loader_error").attr("data-error",t),setTimeout(function(){e.hideLoader(),e.loaderInError=!1,$(".ff-loader").removeClass("ff-loader_error").attr("data-error","")},1e4)}}(),ff.fastResolve=function(e){return $.Deferred().resolve(e).promise()},ff.fastReject=function(e){return $.Deferred().reject(e).promise()},ff.async=function(e,t,n){var r=$.Deferred();return setTimeout(function(){!!t&&t(n),r.resolve(n)},e),r.promise()};var e=[];ff.event={on:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.context,a=void 0===o?{}:o,i=r.order,f=void 0===i?1:i,u=r.bubble,s=void 0===u||u,l=r.label,c=r.once,d=void 0!==c&&c;if("string"!=typeof t)throw new Error("Event name must be string!");if("function"!=typeof n)throw new Error("Event callback must be function!");t in e||(e[t]=[]),e[t].push({callback:n,context:a,order:f,bubble:s,label:l,once:d})},off:function(t,n){if("string"!=typeof t)throw new Error("Event name must be string!");var r=e[t];return!(!r||!r.length)&&("string"==typeof n?(e[t]=r.filter(function(e){return e.label!==n}),!1):"function"!=typeof n?(delete e[t],!1):void(e[t]=r.filter(function(e){return e.callback!==n})))},trigger:function(t,n){if("string"!=typeof t)throw new Error("Event name must be string!");return t in e&&(e[t].sort(function(e,t){var n=e.order,r=t.order;return r-n}).some(function(e){return e.callback.call(e.context,n),e.once&&(e.toDelete=!0),!e.bubble}),void e[t].filter(function(e){return!e.toDelete}))}},ff.HashOfTree=function(){function e(t){_classCallCheck(this,e),this.name=t,this.length=0,this.hash=_defineProperty({},this.name+"_-1",{meta:this.name+"_-1",childrenArr:[],level:0})}return _createClass(e,[{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.name+"_"+this.length++;return this.hash[n]=Object.assign(e,{parentMeta:t,meta:n,childrenArr:e.el.has_child?[]:null,level:t?this.hash[t].level+1:1}),t?this.hash[t].childrenArr.push(n):this.hash[this.name+"_-1"].childrenArr.push(n),n}},{key:"getRegistry",value:function(e){return this.hash[e]}},{key:"getParentRegistry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.getRegistry(e);t<0&&(t=n.level+t);for(var r=1;r<=t&&n.level>1;r++)n=this.getRegistry(n.parentMeta);return n}},{key:"showRegistries",value:function(){console.log(this.hash)}},{key:"getNodeByMeta",value:function(e){var t=this.getRegistry(e);if(!t._node){var n=$("#mustache-target").find('[data-ff="'+e+'"]');t._node=n}return t._node}},{key:"setNodeByMeta",value:function(e,t){var n=this.getRegistry(e);n._node=t}},{key:"getFirstLevelMeta",value:function(){return this.hash[this.name+"_-1"].childrenArr}}]),e}()}(),function(e){var t={};void 0===window.ff&&(window.ff={}),void 0===window.ff.controller&&(window.ff.controller=function(){var e=function(e){return t[e]?{value:t[e].value,clearFunction:t[e].clearFunction||function(){}}:void console.error("Undefined controller "+e)},n=function(e,n,r){if("string"!=typeof e)throw new Error("Key of controller must be String!");t[e]={value:n,clearFunction:r}};return{get:e,set:n}}())}(jQuery);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t;ff.router||(ff.router=function(){function n(t){if("/"===t)return a.filter(function(e){return"/"===e.name&&!e.hashParams})[0]||null;var n=e.router.getParameters(t||"");if(!n.length)return null;var r=n[0].route.route;return a.filter(function(e){var t,n=r===e.name,a=!1,i=!1;return"object"!==("undefined"==typeof r?"undefined":_typeof(r))||"object"!==e.name||e.hashParams||(a=r.source===e.name.source),e.hashParams&&"object"===("undefined"==typeof r?"undefined":_typeof(r))&&(t=o(e.name,e.hashParams),e.param?(t=new RegExp(t.source.replace(":"+e.param,".+")),i=t.source===r.source):i=t.source===r.source),n||a||i})[0]||null}function r(e,t){var n="object"===("undefined"==typeof e?"undefined":_typeof(e))||t?"regexp":"string",r=e;if(t)var r=o(e,t);var i=a.filter(function(e){return e.type===n&&"regexp"===n?e.name.source===r.source:e.name===r});return i[0]||null}function o(e,t){"string"==typeof t&&(t=[t]);var n="object"===e?e.source:e;return n.indexOf("^")===-1&&(n="^"+n),n+="/?#",t.forEach(function(e,t,r){t&&(n+="(?:&"),n+=(t?"":"(?:")+e+"=([^&]+))?",t===r.length-1&&(n+="$")}),new RegExp(n)}var a=[];return{add:function(t,n,i){var f=t,u=0;i||(i={});var s=r(f,i.hashParams);s?(s.name=f,s.controller=n,s.title=i.title,s.hashParams=i.hashParams,s.param=i.param,s.type="object"===("undefined"==typeof f?"undefined":_typeof(f))?"regexp":"string"):a.push({name:f,controller:n,title:i.title,hashParams:i.hashParams,param:i.param,type:"object"===("undefined"==typeof f?"undefined":_typeof(f))?"regexp":"string"}),i.hashParams&&(f=o(f,i.hashParams),i.param&&"string"==typeof t&&(u=t.indexOf(":"),f=new RegExp(f.source.replace(":"+i.param,".+")))),e.router.add(f,i.param,function(e){e.hash={};var t=i.hashParams;t&&("string"==typeof t&&(t=[t]),t.forEach(function(t,n){e.hash[t]=e.matches[n+1]}),delete e.matches);var r,o=window.location.pathname+window.location.hash,a={};u>0&&(r=new RegExp("^.{"+u+"}([^/#]+)"),a=o.match(r),a[1]&&(e[i.param]=a[1])),n.value(e)})},go:function(r,o,a){var i=n(r);i?(o||(o=i.title),t&&t.controller.clearFunction(r),t=i,e.router.go(r,o,!a)):console.error("Undefined route "+r)},updateLinks:function(t){var r=this.go,o=e(t);return o.find("a").filter(function(t,r){return!!n(e(r).attr("href"))&&"_blank"!==e(r).attr("target")}).click(function(t){t.preventDefault(),r(e(this).attr("href"),n(e(this).attr("href")).title,!0)}),o}}}()),function(){var n,r=window.location.pathname;e._data(window,"events").popstate&&e._data(window,"events").popstate[0]&&(n=e._data(window,"events").popstate[0].handler,e._data(window,"events").popstate[0].handler=function(e){if(r===window.location.pathname)return e.preventDefault(),e.stopPropagation(),!1;n.apply(this,arguments);var o=window.location.pathname+window.location.hash;t&&t.controller.clearFunction(o),ff.router.go(o)})}()}(jQuery),$(function(){var e=window.location.pathname+window.location.hash;e.length>1&&/(.+)\/$/.test(e)&&(e=e.slice(0,e.length-1)),ff.router.go(e),ff.router.updateLinks($("body"))});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t={};if(!window.Mustache)throw new Error("Mustache must be required for ff.view !");void 0===window.ff&&(window.ff={}),void 0===window.ff.view&&(window.ff.view=function(){function n(e,t,n){"function"==typeof t&&t(n),e.resolve(n)}return function r(o,a,i){var f,u=window.ff.view.config,s=e.Deferred();return t[o]?a?(f=Mustache.render(t[o],a),"string"==typeof a.layout?r("layouts/"+a.layout).then(function(e){f=Mustache.render(e,a.dataLayout,{partialView:f}),n(s,i,f)}):n(s,i,f)):(f=t[o],n(s,i,f)):e.get(u.root+o+u.ext).done(function(e){t[o]=e,a&&"object"===("undefined"==typeof a?"undefined":_typeof(a))?(f=Mustache.render(e,a),"string"==typeof a.layout?r("layouts/"+a.layout).then(function(e){f=Mustache.render(e,a.dataLayout,{partialView:f}),n(s,i,f)},function(e){s.reject("Can not get layout "+a.layout)}):n(s,i,f)):(f=e,n(s,i,f))}).fail(function(){s.reject("Can not get view "+o)}),s.promise()}}(),window.ff.view.config={root:"/views/",ext:".mst"})}(jQuery);
//# sourceMappingURL=core.js.map
