{"version":3,"sources":["globalSettings.js","controller.js","router.js","view.js"],"names":["undefined","window","ff","config","root","ext","state","loaderIsActive","loaderInError","showLoader","$","addClass","hideLoader","removeClass","errorLoader","err","attr","setTimeout","fastResolve","data","Deferred","resolve","promise","fastReject","reject","async","time","resolveFunction","deff","globalEvents","event","on","callback","_ref","arguments","length","_ref$context","context","_ref$order","order","_ref$bubble","bubble","label","_ref$once","once","Error","push","off","events","filter","el","trigger","sort","_ref2","_ref3","a","b","some","call","toDelete","HashOfTree","name","_classCallCheck","this","hash","_defineProperty","meta","childrenArr","level","_createClass","key","value","item","parentMeta","Object","assign","levelUp","registry","getRegistry","i","console","log","_node","node","find","controllers","controller","get","clearFunction","error","set","jQuery","activeRoute","router","findRoute","route","routes","hashParams","paramRoute","getParameters","paramName","creatingRegExp","check1","check2","check3","_typeof","source","createRegexpByHash","param","RegExp","replace","getRoute","typeOfRoute","routeName","equalRoute","type","base","params","regexpString","indexOf","forEach","arr","add","newName","paramStart","mainController","Array","isArray","title","guardError","parameters","matches","regExpSearchingParam","path","location","pathname","match","lastControler","slice","guards","map","guard","when","apply","then","go","isPushState","document","updateLinks","container","$cont","click","e","preventDefault","originHandler","pathnameNow","_data","handler","stopPropagation","test","views","loadingViews","Mustache","view","resolveDfd","dfd","cb","result","loadTemplate","template","renderView","render","layout","dataLayout","partialView"],"mappings":"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","file":"core.js","sourcesContent":["///here settings for state and config\n\n;(function(){\n\n\tif(window.ff === undefined){\n\t\twindow.ff = {};\n\t}\n\tif(!window.ff.config){\n\t\twindow.ff.config = {}\n\t}\n\twindow.ff.config.root = '/views/';\n\twindow.ff.config.ext = '.mst';\n\n\tif(!window.ff.state){\n\t\twindow.ff.state = {\n\t\t\tloaderIsActive: 'true',\n\t\t\tloaderInError: 'false'\n\t\t};\n\t\tlet state = window.ff.state;\n\t\tstate.showLoader = function(){\n\t\t\tstate.loaderIsActive = true;\n\t\t\t$('.ff-loader').addClass('ff-loader_show');\n\t\t};\n\t\tstate.hideLoader = function(){\n\t\t\tstate.loaderIsActive = false;\n\t\t\t$('.ff-loader').removeClass('ff-loader_show');\n\t\t};\n\t\tstate.errorLoader = function(err){\n\t\t\tstate.loaderIsActive = true;\n\t\t\tstate.loaderInError = false;\n\t\t\t$('.ff-loader').addClass('ff-loader_show')\n\t\t\t\t.addClass('ff-loader_error')\n\t\t\t\t.attr('data-error', err);\n\t\t\tsetTimeout(()=>{\n\t\t\t\tstate.hideLoader();\n\t\t\t\tstate.loaderInError = false;\n\t\t\t\t$('.ff-loader').removeClass('ff-loader_error').attr('data-error', '');\n\t\t\t}, 10000)\n\t\t}\n\t}\n\n\tff.fastResolve = function(data){\n\t\treturn $.Deferred().resolve(data).promise();\n\t}\n\tff.fastReject = function(err){\n\t\treturn $.Deferred().reject(err).promise();\n\t}\n\tff.async = function(time, resolveFunction, data){\n\t\tvar deff = $.Deferred();\n\t\tsetTimeout(function(){\n\t\t\t!!resolveFunction && resolveFunction(data);\n\t\t\tdeff.resolve(data);\n\t\t}, time);\n\t\treturn deff.promise();\n\t}\n\n\tvar globalEvents = [];\n\tff.event = {\n\t\t/*\n\t\t\tfunction on()\n\n\t\t\t@param {String} event – name of event\n\t\t\t@param {Function} callback – callback of event\n\t\t\t@param {Object} options\n\t\t\t\t{Object} contect – contect of callback\n\t\t\t\t{Number} order – order of calling callback, then more the sooner\n\t\t\t\t{Boolean} bubble – if false events whith less order doesn't calling\n\t\t\t\t{String} label - caption of event, for ease removing\n\t\t\t\t{Boolean} once - if true it will call one times\n\t\t */\n\t\ton(event, callback, {context = {}, order = 1, bubble = true, label, once = false} = {}){\n\t\t\tif(typeof event !== 'string'){\n\t\t\t\tthrow new Error('Event name must be string!');\n\t\t\t}\n\t\t\tif(typeof callback !== 'function'){\n\t\t\t\tthrow new Error('Event callback must be function!');\n\t\t\t}\n\t\t\tif(!(event in globalEvents)){\n\t\t\t\tglobalEvents[event] = [];\n\t\t\t}\n\t\t\tglobalEvents[event].push({\n\t\t\t\tcallback,\n\t\t\t\tcontext,\n\t\t\t\torder,\n\t\t\t\tbubble,\n\t\t\t\tlabel,\n\t\t\t\tonce\n\t\t\t});\n\t\t},\n\t\t/*\n\t\t\tfunction off()\n\n\t\t\t@param {String} event – name of event\n\t\t\t@param {Function or String} callback – callback of event or label\n\n\t\t */\n\t\toff(event, callback){\n\t\t\tif(typeof event !== 'string'){\n\t\t\t\tthrow new Error('Event name must be string!');\n\t\t\t}\n\t\t\tvar events = globalEvents[event];\n\t\t\tif(!events || !events.length){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(typeof callback === 'string'){\n\t\t\t\tglobalEvents[event] = events.filter(el => el.label !== callback );\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(typeof callback !== 'function' ){\n\t\t\t\tdelete globalEvents[event];\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tglobalEvents[event] = events.filter(el => el.callback !== callback);\n\t\t},\n\t\t/*\n\t\t\tfunction trigger()\n\n\t\t\t@param {String} event – name of event\n\t\t\t@param {Any} data – data which translate to calling callback\n\t\t */\n\t\ttrigger(event, data){\n\t\t\tif(typeof event !== 'string'){\n\t\t\t\tthrow new Error('Event name must be string!');\n\t\t\t}\n\t\t\tif(!(event in globalEvents)){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tglobalEvents[event].sort(({order: a},{order: b}) => b - a).some(el=>{\n\t\t\t\tel.callback.call(el.context, data);\n\t\t\t\tif(el.once){\n\t\t\t\t\tel.toDelete = true;\n\t\t\t\t}\n\t\t\t\treturn !el.bubble;\n\t\t\t});\n\t\t\tglobalEvents[event].filter(el=>!el.toDelete);\n\t\t}\n\t};\n\n\n\t/*\n\t\tHash of tree helper\n\t\tHelp create trees of data and bind it to nodes\n\t */\n\tff.HashOfTree = class HashOfTree{\n\t\tconstructor(name) {\n\t\t\tthis.name = name;\n\t\t\tthis.length = 0;\n\t\t\tthis.hash = {\n\t\t\t\t[this.name + '_-1']: {\n\t\t\t\t\tmeta: this.name + '_-1',\n\t\t\t\t\tchildrenArr: [],\n\t\t\t\t\tlevel: 0\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tpush(item, parentMeta = null){\n\t\t\tvar meta = this.name + '_' + this.length++;\n\t\t\tthis.hash[meta] = {\n\t\t\t\titem: Object.assign({}, item),\n\t\t\t\tparentMeta,\n\t\t\t\tmeta, \n\t\t\t\tchildrenArr: [],\n\t\t\t\tlevel: parentMeta ? this.hash[parentMeta].level + 1 : 1\n\t\t\t};\n\t\t\tif(!!parentMeta){\n\t\t\t\tthis.hash[parentMeta].childrenArr.push(meta);\n\t\t\t} else{\n\t\t\t\tthis.hash[this.name + '_-1'].childrenArr.push(meta);\n\t\t\t}\n\t\t\treturn meta;\n\t\t}\n\t\tgetRegistry(meta){\n\t\t\treturn this.hash[meta];\n\t\t}\n\t\tgetParentRegistry(meta, levelUp = 1){\n\t\t\tvar registry = this.getRegistry(meta);\n\t\t\tif(levelUp < 0){\n\t\t\t\tlevelUp = registry.level + levelUp;\n\t\t\t}\n\t\t\tfor(var i = 1; i <= levelUp; i++){\n\t\t\t\tif(registry.level > 1){\n\t\t\t\t\tregistry = this.getRegistry(registry.parentMeta);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn registry;\n\t\t}\n\t\tshowRegistries(){\n\t\t\tconsole.log(this.hash)\n\t\t}\n\t\tgetNodeByMeta(meta){\n\t\t\tvar registry = this.getRegistry(meta);\n\t\t\tif(!registry._node){\n\t\t\t\tlet node = $('body').find(`[data-ff=\"${meta}\"]`);\n\t\t\t\tregistry._node = node;\n\t\t\t}\n\t\t\treturn registry._node;\n\t\t}\n\t\tsetNodeByMeta(meta, node){\n\t\t\tvar registry = this.getRegistry(meta);\n\t\t\tregistry._node = node;\n\t\t}\n\t\tgetChildren(meta){\n\t\t\tif( meta === undefined ){\n\t\t\t\tmeta = this.name + '_-1';\n\t\t\t}\n\t\t\treturn this.hash[meta].childrenArr;\n\t\t}\n\t};\n\n\n})();","\n/*\n\tCONTROLLER.js\n\t\n\tnamespace: window.ff.controller\n\t\n\tMethods:\n\n\tget\n\n\t@params: name – name of controller\n\t@return: Object {value, clearFunction}; \n\t\tvalue – function, which called when controller activated, \n\t\tclearFunction – when controller deactivated\n\n\tset\n\n\t@params: name – name of controller,\n\t\tvalue – function, which called when controller activated,\n\t\tclearFunction – function, which called when controller deactivated\n\n\t@return: undefined\n*/\n;(function ($){\n\tvar controllers = {};\n\tif(window.ff === undefined){\n\t\twindow.ff = {};\n\t}\n\tif(window.ff.controller === undefined){\n\t\twindow.ff.controller = (function initController(){\n\t\t\tvar get = function(name){\n\t\t\t\tif(controllers[name]){\n\t\t\t\t\treturn { \n\t\t\t\t\t\tvalue: controllers[name].value, \n\t\t\t\t\t\tclearFunction: controllers[name].clearFunction || function(){}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tconsole.error('Undefined controller ' + name);\n\t\t\t};\n\t\t\tvar set = function(name, value, clearFunction){\n\t\t\t\tif( typeof name !== 'string' ){\n\t\t\t\t\tthrow new Error('Key of controller must be String!');\n\t\t\t\t}\n\t\t\t\tcontrollers[name] = { value: value, clearFunction: clearFunction };\n\t\t\t};\n\t\t\treturn {\n\t\t\t\tget: get,\n\t\t\t\tset: set\n\t\t\t};\n\t\t})();\n\t}\n})(jQuery);","\n\n\n/*\n\tRouter.js\n\n\tff.router.add(name, controller, {title, param, hashParams})\n\t\tname {String or RegExp} Path to route.\n\t\tcontroller {Object of controller} Controller, which bound to route\n\t\ttitle {String} Title of page\n\t\tparam {String} name of dynamic param (see doc of jquery-router-plugin)\n\t\thashParams {String or Array of String} Names of parameters in hash, the order is very important\n\n\tff.router.go(path {String}, title {String}, addToHistory {Boolean});\n */\n\n;(function($){\n\tvar activeRoute;\n\tif(!ff.router){\n\n\t\tff.router = (function(){\n\t\t\tvar routes = [];\n\n\t\t\tfunction findRoute(route){\n\t\t\t\tif(route === '/'){\n\t\t\t\t\treturn routes.filter(function(el){\n\t\t\t\t\t\treturn el.name === '/' && !el.hashParams;\n\t\t\t\t\t})[0] || null;\n\t\t\t\t}\n\t\t\t\tvar paramRoute = $.router.getParameters(route || '');\n\t\t\t\tif(!paramRoute.length){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tvar paramName = paramRoute[0].route.route;\n\n\t\t\t\treturn routes.filter(function(el){\n\t\t\t\t\tvar creatingRegExp;\n\t\t\t\t\tvar check1 = paramName === el.name;\n\t\t\t\t\tvar check2 = false;\n\t\t\t\t\tvar check3 = false;\n\n\t\t\t\t\tif(typeof paramName === 'object' && el.name === 'object' && !el.hashParams){\n\t\t\t\t\t\tcheck2 = paramName.source === el.name.source;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(!!el.hashParams && typeof paramName === 'object'){\n\t\t\t\t\t\tcreatingRegExp = createRegexpByHash(el.name, el.hashParams);\n\t\t\t\t\t\tif(!el.param){\n\t\t\t\t\t\t\tcheck3 = creatingRegExp.source === paramName.source;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcreatingRegExp = new RegExp(creatingRegExp.source.replace(':'+el.param, '.+'));\n\t\t\t\t\t\t\tcheck3 = creatingRegExp.source === paramName.source;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn check1 || check2 || check3;\n\t\t\t\t})[0] || null;\n\t\t\t}\n\n\t\t\tfunction getRoute(route, hash){\n\t\t\t\tvar typeOfRoute = typeof route === 'object' || !!hash ? 'regexp' : 'string';\n\t\t\t\tvar routeName = route;\n\n\t\t\t\tif(!!hash){\n\t\t\t\t\tvar routeName = createRegexpByHash(route, hash);\n\t\t\t\t}\n\n\t\t\t\tvar equalRoute = routes.filter(function(el){\n\t\t\t\t\treturn el.type === typeOfRoute && \n\t\t\t\t\t\ttypeOfRoute === 'regexp' ? \n\t\t\t\t\t\tel.name.source === routeName.source : el.name === routeName;\n\t\t\t\t});\n\n\t\t\t\treturn equalRoute[0] || null;\n\t\t\t}\n\n\t\t\tfunction createRegexpByHash(base, params){\n\t\t\t\tif(typeof params === 'string'){\n\t\t\t\t\tparams = [params];\n\t\t\t\t}\n\n\t\t\t\tvar regexpString = base === 'object' ? base.source : base;\n\t\t\t\tif(regexpString.indexOf('^') === -1){\n\t\t\t\t\tregexpString = '^' + regexpString;\n\t\t\t\t}\n\t\t\t\tregexpString += '/?#';\n\n\t\t\t\tparams.forEach(function(param, i, arr){\n\t\t\t\t\tif(!!i){\n\t\t\t\t\t\tregexpString += '(?:&';\n\t\t\t\t\t}\n\t\t\t\t\tregexpString += (!i ? '(?:' : '') + param + '=([^&]+))?';\n\t\t\t\t\tif(i === arr.length - 1){\n\t\t\t\t\t\tregexpString += '$';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn new RegExp(regexpString);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tadd: function(name, controller, params){\n\t\t\t\t\tvar newName = name;\n\t\t\t\t\tvar paramStart = 0;\n\n\t\t\t\t\tif(!params){\n\t\t\t\t\t\tparams = {};\n\t\t\t\t\t}\n\t\t\t\t\tvar route = getRoute(newName, params.hashParams);\n\t\t\t\t\tvar mainController = controller;\n\t\t\t\t\tif(Array.isArray(controller)){\n\t\t\t\t\t\tmainController = controller[controller.length - 1];\n\t\t\t\t\t}\n\t\t\t\t\tif(!route){\n\t\t\t\t\t\troutes.push({\n\t\t\t\t\t\t\tname: newName,\n\t\t\t\t\t\t\tcontroller: mainController,\n\t\t\t\t\t\t\ttitle: params.title,\n\t\t\t\t\t\t\thashParams: params.hashParams,\n\t\t\t\t\t\t\tparam: params.param,\n\t\t\t\t\t\t\tguardError: params.guardError,\n\t\t\t\t\t\t\ttype: typeof newName === 'object' ? 'regexp' : 'string'\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\troute.name = newName;\n\t\t\t\t\t\troute.controller = controller;\n\t\t\t\t\t\troute.title = params.title;\n\t\t\t\t\t\troute.hashParams = params.hashParams;\n\t\t\t\t\t\troute.param = params.param;\n\t\t\t\t\t\troute.type = typeof newName === 'object' ? 'regexp' : 'string';\n\t\t\t\t\t}\n\t\t\t\t\tif(!!params.hashParams){\n\t\t\t\t\t\tnewName = createRegexpByHash(newName, params.hashParams);\n\t\t\t\t\t\tif(!!params.param && typeof name === 'string'){\n\t\t\t\t\t\t\tparamStart = name.indexOf(':');\n\t\t\t\t\t\t\tnewName = new RegExp(newName.source.replace(':'+params.param, '.+'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t$.router.add(newName, params.param, function(data){\n\t\t\t\t\t\tdata.hash = {};\n\t\t\t\t\t\tvar parameters = params.hashParams;\n\t\t\t\t\t\tif(!!parameters){\n\t\t\t\t\t\t\tif(typeof parameters === 'string'){\n\t\t\t\t\t\t\t\tparameters = [parameters];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tparameters.forEach(function(el, i){\n\t\t\t\t\t\t\t\tdata.hash[el] = data.matches[i + 1];\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tdelete data.matches;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar path = window.location.pathname + window.location.hash;\n\t\t\t\t\t\tvar regExpSearchingParam;\n\t\t\t\t\t\tvar param = {};\n\t\t\t\t\t\tif(paramStart > 0){\n\t\t\t\t\t\t\tregExpSearchingParam = new RegExp('^.{'+ paramStart +'}([^/#]+)');\n\t\t\t\t\t\t\tparam = path.match(regExpSearchingParam);\n\t\t\t\t\t\t\tif(!!param[1]){\n\t\t\t\t\t\t\t\tdata[params.param] = param[1];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(Array.isArray(controller) && controller.length > 1){\n\t\t\t\t\t\t\tvar controllers = controller;\n\t\t\t\t\t\t\tvar lastControler = controllers.slice(-1)[0];\n\t\t\t\t\t\t\tvar guards = controllers.slice(0, -1).map(function(guard){\n\t\t\t\t\t\t\t\treturn guard.value(data);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t$.when.apply(null, guards).then(function(){\n\t\t\t\t\t\t\t\tlastControler.value(data);\n\t\t\t\t\t\t\t}, function(error){\n\t\t\t\t\t\t\t\tif (!!params.guardError){\n\t\t\t\t\t\t\t\t\tif(typeof params.guardError !== 'function'){\n\t\t\t\t\t\t\t\t\t\tthrow new Error('\"guardError\" in options of route must be a function');\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tparams.guardError(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if(Array.isArray(controller) && controller.length === 1){\n\t\t\t\t\t\t\tcontroller[0].value(data);\n\t\t\t\t\t\t} else if(!Array.isArray(controller)){\n\t\t\t\t\t\t\tcontroller.value(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tgo: function(name, title, isPushState){\n\n\t\t\t\t\tvar router = findRoute(name);\n\n\t\t\t\t\tif(router){\n\t\t\t\t\t\tif(!title){\n\t\t\t\t\t\t\ttitle = router.title;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!!activeRoute && activeRoute.controller && typeof activeRoute.controller.clearFunction === 'function'){\n\t\t\t\t\t\t\tactiveRoute.controller.clearFunction(name);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactiveRoute = router;\n\n\t\t\t\t\t\tif(!!title){\n\t\t\t\t\t\t\tdocument.title = title;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$.router.go(name, title, !isPushState);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.error('Undefined route ' + name);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tupdateLinks: function(container){\n\t\t\t\t\t\n\t\t\t\t\tvar go = this.go;\n\t\t\t\t\tvar $cont = $(container);\n\t\t\t\t\t$cont.find('a').filter(function(i, el){\n\t\t\t\t\t\treturn !!findRoute($(el).attr('href')) && $(el).attr('target') !== '_blank' && $(el).attr('data-ff-route') !== 'bind';\n\t\t\t\t\t}).attr('data-ff-route', 'bind').click(function(e){\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tgo($(this).attr('href'), findRoute($(this).attr('href')).title, true);\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\treturn $cont;\n\t\t\t\t\t\n\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t})();\n\t}\n\n\n\t(function(){\n\t\tvar pathnameNow = window.location.pathname;\n\t\tvar originHandler;\n\n\t\t// reinit jquery-router-plugin event for using stopPropagation\n\t\tif(!!$._data(window, 'events')['popstate'] && !!$._data(window, 'events')['popstate'][0]){\n\t\t\toriginHandler = $._data(window, 'events')['popstate'][0].handler;\n\t\t\t$._data(window, 'events')['popstate'][0].handler = function(e){\n\t\t\t\tif(pathnameNow === window.location.pathname){\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\toriginHandler.apply(this, arguments);\n\n\t\t\t\tvar path = window.location.pathname + window.location.hash;\n\t\t\t\tif(!!activeRoute && activeRoute.controller && typeof activeRoute.controller.clearFunction === 'function'){\n\t\t\t\t\tactiveRoute.controller.clearFunction(path);\n\t\t\t\t}\n\t\t\t\tff.router.go(path);\n\t\t\t}\n\t\t}\n\t})();\n\n})(jQuery);\n\n$(function(){\n\n\tvar path = window.location.pathname + window.location.hash;\n\tif(path.length > 1 && /(.+)\\/$/.test(path)){\n\t\tpath = path.slice(0, path.length - 1);\n\t}\n\tff.router.go(path);\n\n\tff.router.updateLinks($('body'));\n\n});","\n\n\n/** view.js expand ff namespace, simple get views with Mustache\n\t* @function ff.view(name, data, callback)\n\t* @param name\n\t\tname of view (must equal file name in views folder withot extention)\n\t* @param data\n\t\tif you want mustache rendered template, set obj, without it, result will be template as it is on server;\n\t\tspecific options: layout – layout name (from view/layouts), dataLayout: data for layout\n\t* @param callback\n\t\tcallback succsess function with one parameter: template (template or mustache rendering)\n\t* @return jQuery Deferrer\n*/\n;(function ($){\n\tvar views = {};\n\tvar loadingViews = {};\n\tif(!window.Mustache){\n\t\tthrow new Error('Mustache must be required for ff.view !');\n\t}\n\tif(window.ff === undefined){\n\t\twindow.ff = {};\n\t}\n\tif(window.ff.view === undefined){\n\t\twindow.ff.view = (function initView(){\n\n\t\t\tfunction resolveDfd(dfd, cb, result){\n\t\t\t\tif(typeof cb === 'function'){\n\t\t\t\t\tcb(result);\n\t\t\t\t}\n\t\t\t\tdfd.resolve(result);\n\t\t\t}\n\n\t\t\tfunction loadTemplate(name){\n\t\t\t\tvar dfd = $.Deferred();\n\t\t\t\tvar config = window.ff.view.config;\n\n\t\t\t\tif(!!loadingViews[name]){\n\t\t\t\t\tdfd = loadingViews[name];\n\t\t\t\t} else if(!views[name]){\n\t\t\t\t\tloadingViews[name] = dfd;\n\t\t\t\t\t$.get(config.root + name + config.ext)\n\t\t\t\t\t\t.then(function(template){\n\t\t\t\t\t\t\tviews[name] = template;\n\t\t\t\t\t\t\tresolveDfd(dfd, null, template);\n\t\t\t\t\t\t\tloadingViews[name] = null;\n\t\t\t\t\t\t\tdelete loadingViews[name];\n\t\t\t\t\t\t}, function(err){\n\t\t\t\t\t\t\tconsole.error(`Can't get view \"${name}\"`);\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tresolveDfd(dfd, null, views[name]);\n\t\t\t\t}\n\n\t\t\t\treturn dfd.promise();\n\t\t\t}\n\n\t\t\treturn function renderView(name, data, cb){\n\t\t\t\tvar dfd = $.Deferred();\n\t\t\t\tvar result;\n\n\t\t\t\tloadTemplate(name)\n\t\t\t\t\t.then(function(template){\n\t\t\t\t\t\tif(data && typeof data === 'object'){\n\t\t\t\t\t\t\tresult = Mustache.render(template, data);\n\n\t\t\t\t\t\t\tif(typeof data.layout === 'string'){\n\t\t\t\t\t\t\t\trenderView('layouts/' + data.layout)\n\t\t\t\t\t\t\t\t\t.then(function(layout){\n\t\t\t\t\t\t\t\t\t\tresult = Mustache.render(layout, data.dataLayout || {}, {partialView: result});\n\t\t\t\t\t\t\t\t\t\tresolveDfd(dfd, cb, result);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tresolveDfd(dfd, cb, result);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult = template;\n\t\t\t\t\t\t\tresolveDfd(dfd, cb, result);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\treturn dfd.promise();\n\t\t\t};\n\n\t\t})();\n\t\twindow.ff.view.config = {\n\t\t\troot: '/views/',\n\t\t\text: '.mst'\n\t\t}\n\t}\n})(jQuery);\n"]}